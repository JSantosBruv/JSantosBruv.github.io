<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Ticker go brrrr</title>
</head>
<body style="background-color: black;">
	<div style="text-align: center; color:white;margin-top: 5em;">
		<div >
		<h1>GME: <b id="GME"></b></h1>
		<h1>AMC: <b id="AMC"></b></h1>
	</div>

	<div style="margin-top: 5em;">
		<h1>AMC Profit: &nbsp;<b id="AMCtotal" style="color:yellow"></b> for <b id="AMCper" style="color:yellow"></b> gain.</h1>
		<h1>GME Profit: &nbsp;<b id="GMEtotal" style="color:yellow"></b> for <b id="GMEper" style="color:yellow"></b> gain.</h1>
		<h1>Total Profit: <b id="profit"></b></h1>
	</div>
	</div>
	
</body>

<script type="text/javascript">

	var lastValue = {GME: 0,AMC: 0,PROFIT:0,PROFITGME:0,PROFITAMC:0,PERAMC:0,PERGME:0};

	const socket = new WebSocket('wss://ws.finnhub.io?token=c309cfiad3i9gms5m3q0');

	// Connection opened -> Subscribe
	socket.addEventListener('open', function (event) {
	    socket.send(JSON.stringify({'type':'subscribe', 'symbol': 'GME'}))
	    socket.send(JSON.stringify({'type':'subscribe', 'symbol': 'AMC'}))
	  
	});

	// Listen for messages
	socket.addEventListener('message', function (event) {

	   const json = JSON.parse(event.data);

	   if (json.type == "trade") {
		
		const value = json.data[0].p;
		const ticker = json.data[0].s;

		var color = "red";

		document.getElementById(ticker).innerHTML= value + "$" ;

		if(value > lastValue[ticker])
			color = "green";

		document.getElementById(ticker).style.color=color;

		lastValue[ticker] = value;

		if(ticker == "GME"){
			var centoit = ((lastValue["GME"]  * 29.68)/182.76);
			var centsess = ((lastValue["GME"] *(35.92-1.18))/161.48);
			var centoitPer = ((lastValue["GME"] *100)/182.76)-100;
			var centsessPer = ((lastValue["GME"] *100)/161.48)-100;


			lastValue["PROFITGME"] =  Math.round(centoit + centsess -1.18,2);
			lastValue["PERGME"] =  Math.round((centsessPer+centoitPer)/2,2);
		
		}
		else{
			var doze = ((lastValue["AMC"] * 60.99)/12.2);
			var quarenta = ((lastValue["AMC"] *(130.18-1.21))/47.3);
			var dozePer = ((lastValue["AMC"] *100)/12.2)-100;
			var quarentaPer = ((lastValue["AMC"] *100)/47.3)-100;

			lastValue["PROFITAMC"] =  Math.round(doze + quarenta -1.21,2);
			lastValue["PERAMC"] =  Math.round((dozePer + quarentaPer) /2,2);
		}
		

		var total = lastValue["PROFITGME"]  + lastValue["PROFITAMC"] + "$";


		document.getElementById(ticker+"total").innerHTML =lastValue["PROFIT"+ticker] +"$";
		document.getElementById(ticker+"per").innerHTML =lastValue["PER"+ticker]  +"%";

		document.getElementById("profit").innerHTML =total;

		var profitColor= "red";

		if(total > lastValue["PROFIT"])
			profitColor = "green";

		document.getElementById("profit").style.color=profitColor;

		lastValue["PROFIT"] = total;

	   }
	});


</script>
</html>